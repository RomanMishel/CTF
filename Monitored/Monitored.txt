nmap:
    Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-31 14:40 EST
Nmap scan report for 10.10.11.248
Host is up (0.11s latency).
Not shown: 996 closed tcp ports (conn-refused)
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 61:e2:e7:b4:1b:5d:46:dc:3b:2f:91:38:e6:6d:c5:ff (RSA)
|   256 29:73:c5:a5:8d:aa:3f:60:a9:4a:a3:e5:9f:67:5c:93 (ECDSA)
|_  256 6d:7a:f9:eb:8e:45:c2:02:6a:d5:8d:4d:b3:a3:37:6f (ED25519)
80/tcp  open  http     Apache httpd 2.4.56
|_http-title: Did not follow redirect to https://nagios.monitored.htb/
|_http-server-header: Apache/2.4.56 (Debian)
389/tcp open  ldap     OpenLDAP 2.2.X - 2.3.X
443/tcp open  ssl/http Apache httpd 2.4.56 ((Debian))
|_http-server-header: Apache/2.4.56 (Debian)
| tls-alpn: 
|_  http/1.1
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=nagios.monitored.htb/organizationName=Monitored/stateOrProvinceName=Dorset/countryName=UK
| Not valid before: 2023-11-11T21:46:55
|_Not valid after:  2297-08-25T21:46:55
|_http-title: Nagios XI
Service Info: Host: nagios.monitored.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.84 seconds

there is login page in nagios.monitored.htb

can do reset password, looked at burpsuit and found some hash that need send in request:
    50546991bd877b4bd0a3c76f4f53f0e33fc93cb266a60a4094e69f59f275741f

tried with hashcat and john,didnt work so much

did dirsearch but didnt find anything useful

did ffuf -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u "https://nagios.monitored.htb/nagiosxi/FUZZ"

find some folders, one of them was api so i did ffuf on this directory as well and found some directories as well,one of them was v1

so i did ffuf on it as well and manage to find:
    authenticate

doesnt give me much

did nmap if UDP ports

sudo nmap -sU -A 10.10.11.248:
    | snmp-sysdescr: Linux monitored 5.10.0-27-amd64 #1 SMP Debian 5.10.205-2 (2023-12-31) x86_64
|_  System uptime: 17h30m35.93s (6303593 timeticks)
| snmp-netstat: 
|   TCP  0.0.0.0:22           0.0.0.0:0
|   TCP  0.0.0.0:389          0.0.0.0:0
|   TCP  10.10.11.248:42278   10.10.14.234:8443
|   TCP  127.0.0.1:25         0.0.0.0:0
|   TCP  127.0.0.1:3306       0.0.0.0:0
|   TCP  127.0.0.1:5432       0.0.0.0:0
|   TCP  127.0.0.1:7878       0.0.0.0:0
|   TCP  127.0.0.1:37578      127.0.1.1:80
|   TCP  127.0.0.1:37590      127.0.1.1:80
|   UDP  0.0.0.0:68           *:*
|   UDP  0.0.0.0:123          *:*
|   UDP  0.0.0.0:161          *:*
|   UDP  0.0.0.0:162          *:*
|   UDP  10.10.11.248:123     *:*
|_  UDP  127.0.0.1:123        *:*
162/udp open          snmp    net-snmp; net-snmp SNMPv3 server
| snmp-info: 
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: 5a44ab2146ff4c6500000000
|   snmpEngineBoots: 26
|_  snmpEngineTime: 17h30m36s
Too many fingerprints match this host to give specific OS details
Network Distance: 2 hops
Service Info: Host: monitored

so i run snmpwalk using :
sudo snmpwalk -Os -c public -v1 > snmp.txt, and manage to find some hash in string :
    iso.3.6.1.2.1.25.4.2.1.5.1406 = STRING: "-u svc /bin/bash -c /opt/scripts/check_host.sh svc XjH7VCehowpR1xZB"
gave the hash to john:
    john passhash.txt --wordlist=/usr/share/wordlists/rockyou.txt

and it manage to crack it:
    !!!josh14!!!.a6_123


